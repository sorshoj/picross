<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

    <script>
            
        var config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        var game = new Phaser.Game(config);
        const  square_length = 100;
        const x = 4;
        const y = 4;
        const Board = new Array(x*y);
        const xclues = new Array();
        const yclues = new Array();

        function preload ()
        {
            this.load.image('square', 'square.png');
            this.load.image('green', 'green_square.png');
            this.load.image('red', 'red.png');


            for (let i = 0; i < Board.length; i++){
                Board[i] = Math.floor(Math.random() * 2);
            }

            generate_xclues();
            generate_yclues();

        }

        function create ()
        {
            let start_x = 0;
            let start_y = 0;
            let margin = 100;
            let mod_val = (square_length*x);

            // turn images into interactive images, with data 0, 1 

            for (let i = 0; i < Board.length; i++) {
                var tent = this.add.image(start_x+margin, start_y+margin, 'square').setOrigin(0,0).setInteractive();
                tent.setData('index', i);
                tent.on('pointerdown', click);

                start_x = (start_x + square_length) % mod_val;
                if (start_x == 0){
                    start_y = start_y + square_length;
                }
            }

            this.add.text(50, 575, "board:"+ Board.toString());
            this.add.text(50, 550, "x clues: " + xclues.toString());
            this.add.text(50, 525, "y clues: " + yclues.toString());

        }

        function update ()
        {

        }

        function click (pointer)
        {
            if (Board[this.getData('index')] == 0) {
                // red
                this.setTint(0xff0000);
            } else {
                // green
                this.setTint(0x05fa46);
            }
        }

        function generate_yclues ()
        {
            let index = 0;
            let count = 0;
            let col = new Array();
            for (let i = 0; i < Board.length; i++) {

                if (Board[index] == 1) {
                    count += 1;
                } else {
                    if (count > 0) {
                        col.push(count);
                    }
                    count = 0;
                }

                index += x;
                if (index >= Board.length) {
                    // first push remaining count to col
                    if (count > 0 | col.length == 0) {
                        col.push(count);
                    }
                    yclues.push(col);
                    col = new Array();
                    count = 0;
                    index = index - Board.length + 1;
                }

            }
            console.log(yclues);

        }


        function generate_xclues () 
        {
            let count = 0;
            let row = new Array();
            for (let i = 0; i < Board.length; i++) {

                if (Board[i] == 1) {
                    count += 1;
                } else {
                    if (count > 0) {
                        row.push(count);
                    }
                    count = 0;
                }

                if (i % x == x-1){
                    if (count > 0) {
                        row.push(count);
                    } 
                    if (row.length == 0) {
                        row.push(0);
                    }
                    xclues.push(row);
                    row = new Array();
                    count = 0;
                }
            }
            console.log(xclues);
        }
    </script>

</body>
</html>